<!DOCTYPE html>
<html>

<head>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>CF Simulator</title>
    <style>
        body {
			font-family: Arial, sans-serif;
			background-color: #f1f1f1;
		}

		#test-form {
			text-align: center;
			background-color: #fff;
			padding: 20px;
			border-radius: 5px;
			box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
			max-width: 600px;
			margin: 0 auto;
		}

		h2 {
			margin-bottom: 10px;
		}

		p {
			margin-top: 0;
		}

		label {
			margin-right: 10px;
		}

		.question {
			border: 1px solid #ddd;
			border-radius: 5px;
			padding: 10px;
			margin-bottom: 10px;
		}

		button {
			margin-top: 20px;
			padding: 10px 20px;
			font-size: 16px;
			background-color: #4CAF50;
			color: #fff;
			border: none;
			border-radius: 4px;
			cursor: pointer;
		}

		button:hover {
			background-color: #45a049;
		}

		#result {
			text-align: left;
			margin-top: 20px;
			display: none;
		}

		/* Regole CSS per rendere il test responsive */
		@media only screen and (min-width: 600px) {
			#test-form {
				padding: 20px;
				max-width:800px;
			}
			input[type=radio] {
				border: 0px;
				width: 10%;
				height: 2em;
			}
			h2 {
				font-size: 26px;
			}

			p {
				font-size: 20px;
			}

			.question {
				font-size: 20px;
				padding: 10px;
				margin-bottom: 10px;
			}

			button {
				font-size: 30px;
				padding: 10px 20px;
			}
		}

				
    </style>
    <script>
        function shuffleArray(array) {
          for (let i = array.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [array[i], array[j]] = [array[j], array[i]];
          }
        }

        function shuffleQuestionsAndAnswers(questionario) {
          shuffleArray(questionario);
        }

        // Funzione per ottenere la risposta dell'utente
        function getAnswer(questionIndex) {
            const answer = document.querySelector(`input[name="answer-${questionIndex}"]:checked`);
            return answer ? answer.value : '';
        }

        function startTest() {
            const questionario = [
            ["L'incidente probatorio può essere richiesto dal PM", "v"],
            ["L'incidente probatorio ha lo scopo di formare la prova", "v"],
            ["L'incidente probatorio viene richiesto per velocizzare il procedimento", "f"],
            ["Il GIP può nominare un consulente tecnico di parte", "f"],
            ["Il procedimento penale Si realizza in due strutture: il tribunale e la Procura", "v"],
            ["Il procedimento penale  Si instaura con l'iscrizione della notizia di reato (da parte del PM)", "v"],
            ["Il procedimento penale si conclude con il giudicato penale", "v"],
            ["Il procedimento penale si instaura su iniziativa di una parte e anche d'ufficio (es. violenza su minore di 18 anni)", "v"],
            ["Il procedimento penale prevede due gradi di giudizio", "f"],
            ["Nel procedimento civile le parti in giudizio sono: l'attore ed il convenuto (procedimento ordinario)", "v"],
            ["Nel procedimento civile le parti in giudizio sono: l'ricorrente ed il resistente (procedimento ordinario)", "f"],
            ["Nel procedimento civile si realizza in un'unica struttura", "v"],
            ["Nel procedimento civile si realizza in Tribunale e Procura", "f"],
            ["Nel procedimento civile Le parti in giudizio sono: il ricorrente ed il resistente (procedimento con ricorso)", "v"],
            ["Nel procedimento civile Le parti in giudizio sono: il ricorrente ed il resistente (procedimento ordinario)", "f"],
            ["Nel procedimento civile si instaura esclusivamente su iniziativa di una parte", "v"],
            ["Nel procedimento civile le parti in giudizio possono nominare un consulente tecnico", "v"],
            ["Il GIP è l'unico interlocutore del Pubblico Ministero", "f"],
            ["Il GIP emette sentenza", "f"],
            ["Il GIP non emette sentenza", "v"],
            ["Il GIP può emettere sentenza di luogo a non procedere", "f"],
            ["Il GIP provvede alle misure cautelari", "v"],
            ["Il GIP può non accogliere la richiesta di archiviazione", "v"],
            ["Il GIP ha autonomia di iniziativa probatoria", "f"],
            ["Il GUP può emettere decreto di rinvio a giudizio", "v"],
            ["Il GUP non può mettere sentenza di luogo a non procedere", "f"],
            ["Il PM conferisce incarico ai sensi dell'art. 360 c.p.p  Quando occorre agire in assoluta urgenza a causa della deperibilità del reperto", "f"],
            ["Il PM conferisce incarico ai sensi dell'art. 360 c.p.p  Quando sussiste il rischio che l'elemento probatorio da analizzare possa venire alterato o distrutto in fase di analisi/accertamento", "v"],
            ["Il PM conferisce incarico ai sensi dell'art. 360 c.p.p Solo quando non vi è il rischio che l'elemento probatorio da analizzare possa venire alterato o distrutto in fase di analisi/accertamento", "f"],
            ["Il PM conferisce incarico ai sensi dell'art. 360 c.p.p indica al perito che deve eseguire un accertamento tecnico non ripetibile", "f"],
            ["Il PM conferisce incarico ai sensi dell'art. 360 c.p.p indica al Consulente Tecnico che deve eseguire un accertamento tecnico ripetibile", "f"],
            ["Il PM conferisce incarico ai sensi dell'art. 360 c.p.p indica al Consulente Tecnico che deve eseguire un accertamento tecnico NON ripetibile", "v"],
            ["Il PM conferisce incarico ai sensi dell'art. 360 c.p.p Quando il PM intende disporre il dissequestro del materiale sequestrato", "v"],
            ["Il PM conferisce incarico ai sensi dell'art. 360 c.p.p Chiedendo autorizzazione al GIP (Giudice Indagini Preliminari)", "f"],
            ["Il PM conferisce incarico ai sensi dell'art. 360 c.p.p - Quando il PM vuole fornire la più ampia garanzia alle parti escludendo il rischio di successive eccezioni", "f"],
            ["L'Organo Giudiziario con funzione requirente/inquirente è il PM", "v"],
            ["L'Organo Giudiziario con funzione requirente/inquirente è il GIP", "f"],
            ["L'Organo Giudiziario con funzione requirente/inquirente è La polizia giudiziaria", "f"],
            ["L'Organo Giudiziario con funzione requirente/inquirente è Il consulente tecnico", "f"],
            ["L'Organo Giudiziario con funzione requirente/inquirente è il perito", "f"],
            ["Chi può prendere parte agli accertamenti tecnici ripetibili ai sensi dell'art 359 c.p.p. L'indagato con il proprio difensore", "f"],
            ["Chi può prendere parte agli accertamenti tecnici ripetibili ai sensi dell'art 359 c.p.p. La persona offesa", "f"],
            ["Chi può prendere parte agli accertamenti tecnici ripetibili ai sensi dell'art 359 c.p.p. il consulente tecnico dell'indagato (CTP)", "f"],
            ["Chi può prendere parte agli accertamenti tecnici ripetibili ai sensi dell'art 359 c.p.p. il consulente tecnico del PM (CTU)", "v"],
            ["Chi può prendere parte agli accertamenti tecnici ripetibili ai sensi dell'art 359 c.p.p. il Perito", "f"],
            ["Chi può prendere parte agli accertamenti tecnici non ripetibili ai sensi dell'art 360 c.p.p. il difensore dell'imputato", "f"],
            ["Chi può prendere parte agli accertamenti tecnici non ripetibili ai sensi dell'art 360 c.p.p. il difensore dell'indagato", "f"],
            ["Chi può prendere parte agli accertamenti tecnici non ripetibili ai sensi dell'art 360 c.p.p. l'imputato", "f"],
            ["Chi può prendere parte agli accertamenti tecnici non ripetibili ai sensi dell'art 360 c.p.p. il difensore dell'IMPUTATO accompagnato da CTP", "f"],
            ["Chi può prendere parte agli accertamenti tecnici non ripetibili ai sensi dell'art 360 c.p.p. il difensore dell'INDAGATO accompagnato da CTP", "v"],
            ["Chi può prendere parte agli accertamenti tecnici non ripetibili ai sensi dell'art 360 c.p.p. il perito del GIP", "f"],
            ["Chi può prendere parte agli accertamenti tecnici non ripetibili ai sensi dell'art 360 c.p.p. il perito del GUP", "f"],
            ["Chi può prendere parte agli accertamenti tecnici non ripetibili ai sensi dell'art 360 c.p.p. il CTP della parte offesa", "v"],
            ["Chi può prendere parte agli accertamenti tecnici non ripetibili ai sensi dell'art 360 c.p.p. il Perito", "f"],
            ["Quando si giunge al Giudicato Penale? quando il giudice deposita la sentenza", "f"],
            ["Quando si giunge al Giudicato Penale? Quando viene emessa la sentenza dalla Corte di Cassazione", "v"],
            ["Quando si giunge al Giudicato Penale? Quando viene emessa la sentenza della Corte d'appello", "f"],
            ["Quando si giunge al Giudicato Penale? Quando sono decorsi i termini per proporre opposizione/impugnazione", "v"],
            ["", "f"],
            ["", "f"],
            ["", "f"],
            ["", "f"],
            ["", "f"],
            ["", "f"],
            ["", "f"],
            ["", "f"],
            ["", "f"],
            ["", "f"],
            ["", "f"],
            // Aggiungi qui tutte le altre domande e risposte del questionario
            ];
            console.log("Domande nel questionario: " + questionario.length);
            shuffleQuestionsAndAnswers(questionario);

            questionario.splice(30); // prendi le prime 30 domande
            const numQuestions = questionario.length;
            let score = 0;
            let wrongAnswers = [];

            const testForm = document.getElementById('test-form');
            const resultDiv = document.getElementById('result');

            testForm.innerHTML = '';

            const heading = document.createElement('h2');
            heading.textContent = 'Test di teoria di Computer Forensics';
            testForm.appendChild(heading);

            const instruction = document.createElement('p');
            instruction.textContent =
            "Rispondi a tutte e 30 le domande con 'Vero' o 'Falso'. Se non sai rispondere a una domanda, lasciala in bianco e ti sarà rivelata alla fine del test (domanda non risposta 0 punti, domanda corretta +1, domanda errata -0.5). Clicca il pulsante in fondo al test per visualizzare il risultato:";
            testForm.appendChild(instruction);

            for (let i = 0; i < numQuestions; i++) {
            const question = questionario[i][0];
            const answer = questionario[i][1];

            const questionDiv = document.createElement('div');
            questionDiv.classList.add('question');

            const questionText = document.createElement('p');
            questionText.textContent = (i+1) + '. ' + question;
            questionDiv.appendChild(questionText);

            const trueLabel = document.createElement('label');
            trueLabel.textContent = 'Vero';
            const trueInput = document.createElement('input');
            trueInput.type = 'radio';
            trueInput.name = `answer-${i}`;
            trueInput.value = 'v';
            trueLabel.appendChild(trueInput);
            questionDiv.appendChild(trueLabel);

            const falseLabel = document.createElement('label');
            falseLabel.textContent = 'Falso';
            const falseInput = document.createElement('input');
            falseInput.type = 'radio';
            falseInput.name = `answer-${i}`;
            falseInput.value = 'f';
            falseLabel.appendChild(falseInput);
            questionDiv.appendChild(falseLabel);

            testForm.appendChild(questionDiv);
            }
            
            const submitButton = document.createElement('button');
            submitButton.textContent = 'Invia';
            testForm.appendChild(submitButton);

            submitButton.addEventListener('click', function () {
            var alreadyAskedToExit = false;
            for (let i = 0; i < numQuestions; i++) {
              const answer = getAnswer(i);
              if (answer === '' && !alreadyAskedToExit) {
                var domandeInBianco = [];
                for (let j = 0; j < numQuestions; j++){
                  if(getAnswer(j)===''){
                    domandeInBianco.push(j+1);
                  }
                }
                const confirmed = confirm('Sicuro di voler consegnare? Ci sono domande senza risposta ('+domandeInBianco+').');
                alreadyAskedToExit =true;
                if (!confirmed) {
                  return;
                }
              }
              if (answer === questionario[i][1]) {
              score++;
              } else {
                var lasciataInBianco = (answer === '')? true:false;
                if(!lasciataInBianco)
                    score-=0.5;
                wrongAnswers.push({
                lasciataInBianco: lasciataInBianco,
                question: questionario[i][0],
                correctAnswer: questionario[i][1],
                index: i
              });
              }
            }

            //var trentesimi = (score / numQuestions) * 30;
            resultDiv.innerHTML =
              '<h1>Hai totalizzato ' +
              score +
              ' punti su ' +
              numQuestions +
              '.';
            if (wrongAnswers.length > 0) {
              resultDiv.innerHTML += '<h2>Le risposte sbagliate sono:</h2>';
              for (let i = 0; i < wrongAnswers.length; i++) {
              resultDiv.innerHTML +=
                '<strong>Domanda ' + (wrongAnswers[i].index + 1) +
                 (wrongAnswers[i].lasciataInBianco ? ' - Lasciata in bianco':'')+
                ':</strong> ' +
                wrongAnswers[i].question +
                '<br>';
              resultDiv.innerHTML +=
                'Risposta corretta: ' +
                (wrongAnswers[i].correctAnswer==='v' ? 'Vero' : 'Falso') +
                '<br><br>';
              }
            }
            resultDiv.style.display = 'block';

            testForm.style.display = 'none';

            const retryButton = document.createElement('button');
            retryButton.textContent = 'Riprova';
            retryButton.addEventListener('click', function () {
              resultDiv.style.display = 'none';
              testForm.style.display = 'block';
              startTest();
            });

            resultDiv.appendChild(retryButton);
            });
          }
    </script>
</head>
<body>
    <div id="test-form">
		<h1>Simulatore di CF</h1>
        <p>Chat GPT ha generato automaticamente il codice HTML, CSS e JavaScript di questo simulatore.</p>
		<p>Il codice sorgente di questo progetto è completamente Open Source. Se lo desideri, puoi contribuire per arricchire il questionario e migliorare l'esperienza di apprendimento per le future matricole.</p>
        <p>Puoi trovare il codice sorgente su <a href="https://github.com/AlessandroBonomo28/LP1-simulator">GitHub</a>.</p>
		<button onclick="startTest()">Inizia il Test</button>
    </div>
    <div id="result" style="display: none;"></div>
</body>
</html>
